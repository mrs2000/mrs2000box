(function(c){jQuery.fn.mrs2000box=function(d){function I(){function a(){1<b.length&&(k=!1,w=1==x?B():C(),f.src=b[w].href)}0<c(".m2b-shadow").length||(l=c('<div class="m2b-shadow"></div>'),l.appendTo("body").click(p),e=c('<div class="m2b-frame"><div class="m2b-shadow2"></div><div class="m2b-spinner"><div class="m2b-double-bounce1"></div><div class="m2b-double-bounce2"></div></div><img class="m2b-image"><div class="m2b-error"></div><div class="m2b-left"></div><div class="m2b-right"></div><div class="m2b-btn-close"></div><div class="m2b-title"></div></div>'),
e.appendTo("body"),q=e.find(".m2b-spinner"),m=e.find(".m2b-image"),m.hide().load(function(){(d.showNumber||d.showTitle)&&""!=h.html()&&(D=!0,h.show());E();q.hide()}).click(function(){(2>b.length||!d.showGallery)&&p()}),r=e.find(".m2b-left"),t=e.find(".m2b-right"),r.click(F),t.click(G),h=e.find(".m2b-title"),(d.showTitle||d.showNumber)&&h.show(),y=e.find(".m2b-error"),e.find(".m2b-btn-close").click(p),f=new Image,f.onload=function(){k?(u=f.width,v=f.height,m.attr("src",f.src).show(),a()):k=!0},f.onerror=
function(){k&&(y.show(),q.hide(),a())},c(window).resize(function(){E()}),c(document).keyup(function(a){if(z)switch(a.which){case 27:p();break;case 37:F();break;case 39:G()}}))}function E(){var a=e.width(),b=e.height(),d=u/v,c,n;D&&(b-=h.outerHeight());1<d?(c=u>a?a:u,n=c/d):(n=v>b?b:v,c=n*d);m.css({top:.5*b-.5*n,left:.5*a-.5*c,width:c,height:n})}function A(){h.html(b[g].title).hide();m.hide();q.show();y.hide();k=!0;w=g;f.src=b[g].href}function C(){var a=g-1;-1==a&&(a=b.length-1);return a}function B(){var a=
g+1;a==b.length&&(a=0);return a}function F(){1<b.length&&d.showGallery&&(x=0,g=C(),A())}function G(){1<b.length&&d.showGallery&&(x=1,g=B(),A())}function H(a){var b="";d.showNumber&&a.rel&&(b+="<b>\u0424\u043e\u0442\u043e \u2116"+a.rel+"</b> ");return b+a.title}function J(a){a.on("click","a",function(c){c.preventDefault();null==l?I():(l.show(),e.show());b=[];if(d.showGallery){var f=this;a.find("a").each(function(a,c){c==f&&(g=a);b.push({href:c.href,title:H(c)})})}else b.push({href:this.href,title:H(this)});
1<b.length&&d.showGallery?(r.show(),t.show()):(r.hide(),t.hide());A();z=!0})}function p(){l.hide();e.hide();z=!1}d=c.extend({showTitle:!0,showNumber:!0,showGallery:!0},d);var q,l,m,f,e,r,t,h,y,b=[],g,x=1,u,v,D,z=!1,k=!0,w;return c(this).each(function(){J(c(this))})}})(jQuery);