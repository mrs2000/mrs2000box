'use strict';(function(b){jQuery.fn.mrs2000box=function(a){function M(){h=b(".m2b-shadow");0==h.length?(h=b('<div class="m2b-shadow"></div>'),h.appendTo("body").click(t),c=b('<div class="m2b-frame"><div class="m2b-shadow2"></div><div class="m2b-spinner"><div class="m2b-double-bounce1"></div><div class="m2b-double-bounce2"></div></div><img class="m2b-image"><div class="m2b-error"></div><div class="m2b-left"></div><div class="m2b-right"></div><div class="m2b-btn-close"></div><div class="m2b-title"></div></div>'),
c.appendTo("body")):(c=b(".m2b-frame"),c.show(),h.show());u=c.find(".m2b-spinner");f=c.find(".m2b-image");f.hide().load(N).click(B);c.click(B);p=c.find(".m2b-left");q=c.find(".m2b-right");p.click(C);q.click(D);k=c.find(".m2b-title");(a.showTitle||a.showNumber)&&k.show();v=c.find(".m2b-error");v.hide();x=c.find(".m2b-btn-close");x.click(t);g=new Image;g.onload=function(){r?(l=g.naturalWidth,m=g.naturalHeight,f.attr("src",g.src).show(),E()):r=!0};g.onerror=function(){r&&(v.show(),f.hide(),u.hide(),
E())};b(window).bind("resize",F);b(document).bind("keyup",G)}function F(){if(w&&(H(),a.onResize))a.onResize({width:l,height:m,object:d[e].object,img:f})}function G(n){if(w)switch(n.which){case 27:t();break;case 37:C();break;case 39:D()}}function H(){var n=c.width(),a=c.height(),d=l/m,b,e;I&&(a-=k.outerHeight());d>n/a?(b=l>n?n:l,e=b/d):(e=m>a?a:m,b=e*d);f.css({top:.5*a-.5*e,left:.5*n-.5*b,width:b,height:e})}function N(){""!=k.html()&&(I=!0,k.show());if(a.onLoad)a.onLoad({width:l,height:m,object:d[e].object,
img:this});H();u.hide()}function B(){(2>d.length||!a.showGallery)&&t()}function y(){if(a.onBeforeLoad)a.onBeforeLoad({img:f});(a.showTitle||a.showNumber)&&k.html(d[e].title).hide();f.hide();u.show();v.hide();r=!0;z=e;g.src=d[e].href}function E(){1<d.length&&(r=!1,z=1==A?J():K(),g.src=d[z].href)}function K(){var a=e-1;-1==a&&(a=d.length-1);return a}function J(){var a=e+1;a==d.length&&(a=0);return a}function C(){1<d.length&&a.showGallery&&(A=0,e=K(),y())}function D(){1<d.length&&a.showGallery&&(A=1,
e=J(),y())}function L(d){var b="";a.showNumber&&d.rel&&(b+="<b>\u0424\u043e\u0442\u043e \u2116"+d.rel+"</b> ");return b+d.title}function t(){h.hide();c.hide();p.unbind("click");q.unbind("click");x.unbind("click");f.unbind("load");f.unbind("click");c.unbind("click");b(window).unbind("resize",F);b(document).unbind("keyup",G);w=!1;if(a.onClose)a.onClose()}a=b.extend({showTitle:!0,showNumber:!0,showGallery:!1,advanced:!1,onBeforeLoad:null,onLoad:null,onResize:null,onClose:null},a);a.advanced&&(a.showGallery=
!0,a.showTitle=!0,a.showNumber=!0);var u=null,h=null,f=null,c=null,p=null,q=null,x=null,k=null,v=null,d=[],e=0,g=null,A=1,l,m,I,w=!1,r=!0,z;return b(this).each(function(){var c;if("A"==this.tagName){c=b(this).parent();if(c.data("m2b"))return;c.data("m2b",!0)}else c=b(this);c.on("click","a",function(b){b.preventDefault();M();d=[];if(a.showGallery){var f=this;c.find("a").each(function(a,b){b==f&&(e=a);d.push({object:b,href:b.href,title:L(b)})})}else d.push({object:this,href:this.href,title:L(this)});
1<d.length&&a.showGallery?(p.show(),q.show()):(p.hide(),q.hide());y();w=!0})})}})(jQuery);